<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Minha Rotina - Financeiro</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f2f2f2; }
    .container { max-width: 600px; margin: auto; padding: 20px; background: #fff; min-height: 100vh; }
    h1 { text-align: center; }
    .card { background: #fafafa; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
    .btn { display: inline-block; padding: 8px 12px; border: none; border-radius: 4px; color: #fff; cursor: pointer; }
    .btn-salario { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); }
    .btn-reset { background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); }
    .btn-modal { background: linear-gradient(135deg, #6c757d 0%, #495057 100%); }
    .input-grupo { margin-bottom: 10px; }
    .input-grupo label { display: block; margin-bottom: 5px; font-weight: 600; }
    .input-grupo input { width: 100%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; }
    .gasto-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; padding: 8px; border-radius: 6px; background: #fff; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 1000; }
    .modal-conteudo { background: #fff; padding: 20px; border-radius: 10px; width: 90%; max-width: 400px; }
  </style>
</head>
<body>
  <div class="container">
     <h1>Controle Financeiro</h1>
     <div id="resumo" class="card"></div>

     <div class="card">
       <div style="display:flex; justify-content:space-between; align-items:center;">
          <h2 style="margin:0;">üè† Gastos Fixos</h2>
          <button onclick="abrirModal('modalFixo')" class="btn btn-modal">+ Adicionar</button>
       </div>
       <div id="listaFixos"></div>
     </div>

     <div class="card">
       <div style="display:flex; justify-content:space-between; align-items:center;">
          <h2 style="margin:0;">üìù Gastos Vari√°veis</h2>
          <button onclick="abrirModal('modalVariavel')" class="btn btn-modal">+ Adicionar</button>
       </div>
       <div id="listaVariaveis"></div>
     </div>

     <div style="display:flex; gap:10px;">
        <button onclick="mostrarSalario()" class="btn btn-salario" style="flex:1">üíµ Sal√°rio</button>
        <button onclick="resetarGastosVariaveis()" class="btn btn-reset" style="flex:1">üîÑ Resetar Gastos</button>
     </div>
  </div>

  <!-- Modal Sal√°rio -->
  <div id="modalSalario" class="modal">
    <div class="modal-conteudo">
      <h3 style="margin-top:0;">üíµ Configurar Sal√°rio</h3>
      <div class="input-grupo">
        <label>Sal√°rio Mensal:</label>
        <input type="number" id="salarioInput" step="0.01" placeholder="Ex: 5000">
      </div>
      <div style="display:flex; gap:10px; margin-top:15px;">
        <button class="btn btn-salario" onclick="salvarSalario()" style="flex:1">‚úÖ Salvar</button>
        <button class="btn btn-modal" onclick="fecharModal('modalSalario')" style="flex:1">‚ùå Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal Gasto Fixo -->
  <div id="modalFixo" class="modal">
    <div class="modal-conteudo">
      <h3 style="margin-top:0;">üè† Adicionar Gasto Fixo</h3>
      <div class="input-grupo">
        <label>Descri√ß√£o:</label>
        <input type="text" id="descricaoGastoFixo" placeholder="Ex: Aluguel">
      </div>
      <div class="input-grupo">
        <label>Valor Mensal:</label>
        <input type="number" id="valorGastoFixo" placeholder="Ex: 1500" step="0.01">
      </div>
      <div style="display:flex; gap:10px; margin-top:15px;">
        <button class="btn btn-salario" onclick="salvarGastoFixo()" style="flex:1">‚úÖ Salvar</button>
        <button class="btn btn-modal" onclick="fecharModal('modalFixo')" style="flex:1">‚ùå Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal Gasto Vari√°vel -->
  <div id="modalVariavel" class="modal">
    <div class="modal-conteudo">
      <h3 style="margin-top:0;">üìù Adicionar Gasto</h3>
      <div class="input-grupo">
        <label>Descri√ß√£o:</label>
        <input type="text" id="descricaoGastoVariavel" placeholder="Ex: Supermercado">
      </div>
      <div class="input-grupo">
        <label>Valor:</label>
        <input type="number" id="valorGastoVariavel" placeholder="Ex: 150.00" step="0.01">
      </div>
      <div class="input-grupo">
        <label>Data:</label>
        <input type="date" id="dataGastoVariavel">
      </div>
      <div style="display:flex; gap:10px; margin-top:15px;">
        <button class="btn btn-salario" onclick="salvarGastoVariavel()" style="flex:1">‚úÖ Salvar</button>
        <button class="btn btn-modal" onclick="fecharModal('modalVariavel')" style="flex:1">‚ùå Cancelar</button>
      </div>
    </div>
  </div>

  <script>
    let configFinanceira = JSON.parse(localStorage.getItem('configFinanceira')) || { salario: 0 };
    let gastosFixos = JSON.parse(localStorage.getItem('gastosFixos')) || [];
    let gastosVariaveis = JSON.parse(localStorage.getItem('gastosVariaveis')) || [];
    let mesAtual = new Date().getMonth() + '-' + new Date().getFullYear();

    function abrirModal(id) { document.getElementById(id).style.display = 'flex'; }
    function fecharModal(id) { document.getElementById(id).style.display = 'none'; }

    function mostrarSalario() {
      document.getElementById('salarioInput').value = configFinanceira.salario || '';
      abrirModal('modalSalario');
    }

    function salvarSalario() {
      const salario = parseFloat(document.getElementById('salarioInput').value) || 0;
      if (salario <= 0) { alert('Por favor, insira um sal√°rio v√°lido!'); return; }
      configFinanceira.salario = salario;
      localStorage.setItem('configFinanceira', JSON.stringify(configFinanceira));
      fecharModal('modalSalario');
      atualizarResumo();
    }

    function salvarGastoFixo() {
      const desc = document.getElementById('descricaoGastoFixo').value.trim();
      const valor = parseFloat(document.getElementById('valorGastoFixo').value);
      if (!desc) { alert('Por favor, digite a descri√ß√£o do gasto fixo!'); return; }
      if (!valor || valor <= 0) { alert('Por favor, digite um valor v√°lido!'); return; }

      gastosFixos.push({ id: Date.now(), descricao: desc, valor });
      localStorage.setItem('gastosFixos', JSON.stringify(gastosFixos));
      fecharModal('modalFixo');
      atualizarListas();
    }

    function salvarGastoVariavel() {
      const desc = document.getElementById('descricaoGastoVariavel').value.trim();
      const valor = parseFloat(document.getElementById('valorGastoVariavel').value);
      const data = document.getElementById('dataGastoVariavel').value;
      if (!desc) { alert('Por favor, digite a descri√ß√£o do gasto!'); return; }
      if (!valor || valor <= 0) { alert('Por favor, digite um valor v√°lido!'); return; }
      if (!data) { alert('Por favor, selecione a data!'); return; }

      gastosVariaveis.push({ id: Date.now(), descricao: desc, valor, data, mes: mesAtual });
      localStorage.setItem('gastosVariaveis', JSON.stringify(gastosVariaveis));
      fecharModal('modalVariavel');
      atualizarListas();
    }

    function excluirGastoFixo(id) {
      if (confirm('Tem certeza que deseja excluir este gasto fixo?')) {
        gastosFixos = gastosFixos.filter(g => g.id !== id);
        localStorage.setItem('gastosFixos', JSON.stringify(gastosFixos));
        atualizarListas();
      }
    }

    function excluirGastoVariavel(id) {
      if (confirm('Tem certeza que deseja excluir este gasto?')) {
        gastosVariaveis = gastosVariaveis.filter(g => g.id !== id);
        localStorage.setItem('gastosVariaveis', JSON.stringify(gastosVariaveis));
        atualizarListas();
      }
    }

    function resetarGastosVariaveis() {
      if (confirm('Tem certeza que deseja resetar todos os gastos vari√°veis do m√™s? Esta a√ß√£o n√£o pode ser desfeita!')) {
        gastosVariaveis = gastosVariaveis.filter(g => g.mes !== mesAtual);
        localStorage.setItem('gastosVariaveis', JSON.stringify(gastosVariaveis));
        atualizarListas();
        alert('Gastos vari√°veis resetados com sucesso!');
      }
    }

    function atualizarResumo() {
      const salario = configFinanceira.salario || 0;
      const totalFixos = gastosFixos.reduce((t, g) => t + g.valor, 0);
      const gastosMes = gastosVariaveis.filter(g => g.mes === mesAtual).reduce((t, g) => t + g.valor, 0);
      const rendaDisponivel = salario - totalFixos;
      const saldoFinal = rendaDisponivel - gastosMes;

      if (salario === 0) {
        document.getElementById('resumo').innerHTML = '<p>Configure seu sal√°rio para come√ßar.</p>';
        return;
      }

      document.getElementById('resumo').innerHTML = `
        <div><strong>Sal√°rio:</strong> R$ ${salario.toFixed(2).replace('.', ',')}</div>
        <div><strong>Gastos Fixos:</strong> R$ ${totalFixos.toFixed(2).replace('.', ',')}</div>
        <div><strong>Gastos do M√™s:</strong> R$ ${gastosMes.toFixed(2).replace('.', ',')}</div>
        <div><strong>Saldo Final:</strong> R$ ${saldoFinal.toFixed(2).replace('.', ',')}</div>
      `;
    }

    function atualizarListas() {
      const listaFixos = document.getElementById('listaFixos');
      const listaVariaveis = document.getElementById('listaVariaveis');

      listaFixos.innerHTML = gastosFixos.length ? gastosFixos.map(g => `
        <div class="gasto-item">
          <div>${g.descricao}</div>
          <div>
            R$ ${g.valor.toFixed(2).replace('.', ',')}
            <button onclick="excluirGastoFixo(${g.id})">üóëÔ∏è</button>
          </div>
        </div>
      `).join('') : '<p style="text-align:center;">Nenhum gasto fixo cadastrado</p>';

      const gastosDoMes = gastosVariaveis.filter(g => g.mes === mesAtual);
      listaVariaveis.innerHTML = gastosDoMes.length ? gastosDoMes.map(g => {
        const data = new Date(g.data).toLocaleDateString('pt-BR');
        return `
          <div class="gasto-item">
            <div>${g.descricao} - ${data}</div>
            <div>
              R$ ${g.valor.toFixed(2).replace('.', ',')}
              <button onclick="excluirGastoVariavel(${g.id})">üóëÔ∏è</button>
            </div>
          </div>
        `;
      }).join('') : '<p style="text-align:center;">Nenhum gasto registrado este m√™s</p>';

      atualizarResumo();
    }

    atualizarListas();
  </script>
</body>
</html>
